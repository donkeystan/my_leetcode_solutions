#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<stdbool.h>

#define MAX 10000
int push(char);
char pop();
int pair_chk(char, char);

int TOP = -1;
char STACK[MAX];

bool isValid(char * s)
{
    int i;
    char left_bracket;
    char right_bracket;
    int rc = 0;
    int pair_count = 0;

    for(i=0; s[i]!='\0'; i++)
    {
        if( s[i] == '(' || s[i] == '[' || s[i] == '{' )                                                 // initiate push when seeing left bracket
        {
            left_bracket = s[i];
            rc = push(left_bracket);                                                                   
            printf("s[%d]---> %c, pushed in STACK[%d] \n",i,left_bracket,TOP);
            if( rc == 0 )                                                                                // out of length limit, progam terminated, and return false (not in even number of length)
            {
                return false;                                                                  
            }
        }
        
        if( s[i] == ')' || s[i] == ']' || s[i] == '}' )
        {
            left_bracket = pop();                                                                          // pop a left bracket to pair with right bracker
            if( left_bracket == '(' || left_bracket == '[' || left_bracket == '{' )
            {
                right_bracket = s[i];
                rc = pair_chk(left_bracket, right_bracket);                                                // use pair chk function to check the validaty of the bracket pair
                if(rc == 1)
                {
                    pair_count++;
                    printf("Pair of ' %c  %c ' ---> %d Pair \n",left_bracket,right_bracket,pair_count);    // additional check for pair check and pair count
                }
                else                                                                                       
                {
                    TOP = -1;                                                                              // default TOP to -1 before checking process ends
                    return false;                                                                          // return false if they don't match.
                }
               
            }
            else
            {
                TOP = -1;                                                                                  // default TOP to -1 before checking process ends
                return false;                                                                              // return false if poped bracket is not a legal left bracket
            }
        }
    }

    if(TOP != -1)
    {
        TOP = -1;                                                                                // default TOP to -1 before checking process ends
        return false;                                                                            // after all push and pop, it will be invalid if anything remains in stack, retrun false
    }
    TOP = -1;                                                                                    // default TOP to -1 before checking process ends
    return true;                                                                                 // if TOP is -1 after all process , it means all parentheses are paired and checked valid, return true.
}


/*
Algorithm:

1. set up a Global variable for push and pop as TOP by default value -1
2. create the push and pop functions, push starts from 0, and full as 1000, pop limit to be 0
3. create a pair check functions to check if {} [] () can be paired, return 1 as true, and 0 as false

4. Process starts
    for loop to scan the string till NULL char.
        if left bracket ( [ {  found, push it into stack
            additional - if to check if push returns 0 as stack being full, which means all paired situation would not occured since it's odd nums of stack

        if right bracket ) ] } found,
            
            pop one left bracket in the stack to check pair with right bracket
            
            if poped out bracket is a left bracket, do pair check
                if pair check returns 1, do nothing, and loop continues

                else not paired, meaning illegal pair, return false, end process

            else
                not a left bracket, illegal, return false

    After for loop scan ends,
    if TOP is not default to -1, meanning something remains in STACK, amount of brackets not paired, return false

    if nothing happens, and all process goes to the end while TOP is at default -1, it means all brackets are paired.
    return true

*/

int main()
{
    int i;
    char *str[] = { 
        "()",
        "()[]{}",
        "(]",
        "([)]",
        "{[]}",
        "{}{}[]",
        "[([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([([()])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])])]"
    };
    bool rc;

    for(i=0; i<7; i++)
    {
        rc = isValid(str[i]);
        printf("rc--->%d\n",rc);
    }
    


    // rc = isValid("()");
    // printf("rc--->%d\n",rc);
    // rc = isValid("()[]{}");
    // printf("rc--->%d\n",rc);
    // rc = isValid("(]");
    // printf("rc--->%d\n",rc);
    // rc = isValid("([)]");
    // printf("rc--->%d\n",rc);
    // rc = isValid("{[]}");
    // printf("rc--->%d\n",rc);

    return 0;
}


int pair_chk(char l_bracket, char r_bracket)
{
    if( l_bracket == '(' && r_bracket == ')' )
    {
        return 1;
    }
    else if( l_bracket == '[' && r_bracket == ']' )
    {
        return 1;
    }
    else if( l_bracket == '{' && r_bracket == '}' )
    {
        return 1;
    }
    else
    {
        return 0;
    }
}

char pop()
{
    char bracket;
    if(TOP == -1)
    {
        printf("Stack is empty!\n");
        return '\0';
    }
    else
    {
        bracket = STACK[TOP];
        TOP--;
        return bracket;
    }
}

int push(char bracket)
{
    if(TOP == MAX-1)
    {
        printf("Stack is full!\n");
        return 0;
    }
    else
    {
        TOP++;
        STACK[TOP] = bracket;
        return 1;
    }
}
/*

20. Valid Parentheses

Given a string s containing just the characters '(', ')', '{', '}', '[' and ']', determine if the input string is valid.

An input string is valid if:

Open brackets must be closed by the same type of brackets.
Open brackets must be closed in the correct order.
 
Example 1:
Input: s = "()"
Output: true

Example 2:
Input: s = "()[]{}"
Output: true

Example 3:
Input: s = "(]"
Output: false

Example 4:
Input: s = "([)]"
Output: false

Example 5:
Input: s = "{[]}"
Output: true

Constraints:

1 <= s.length <= 104
s consists of parentheses only '()[]{}'.
*/